Compress ← ⊕⊢:⟜(⟜⊕/+⊛)
Solve ← (
  ⊙(⟜(⊙::⊢⇌⊢⇌))
  ⍥(Compress⊙::⤙(
      ≡(⊙[.]◫2⍜(↘1)⇌⊂⟜get⊙:)
      ⊓(☇1|☇0))
  )
  ⊙⊙◌
)

°$"_\n\n_" &fras "input"
⊓(⟜(+1⊚⧻)◫2|¤map⊜°$"_ -> _"≠@\n.)
⊃(Solve40|Solve10)
∩(-⊃(⊢⇌)⊢◌Compress⊂:⊙(:⊂1)≡⊢)

