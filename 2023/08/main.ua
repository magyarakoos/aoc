GCD ← ◌⍢⊃◿∘±

SolveA! ← (
  ⊙⊙⊙0
  ⍢(⊙⊙⊙(+1)⊏:⊙°⊂⊙:get⊙.⊙:|^!)
  ◌◌◌
)
SolveB ← (
  ⊙(≡□▽≡(=@A⊢⇌).⊙◌°map.)
  ☇1⊞⊂⊙□⍉⊟:□
  ≡(SolveA!(≠@Z⊢⇌)⊙(∩°□°⊟)°□°⊂)
  /(÷⊃GCD×)
)

&fras "input"
∩°□°⊟⊜□¬⦷"\n\n".
⊙(map≡°⊂⊜[°$"_ = (_, _)"]≠@\n.)
⍥(⊂.)15=@R
⊃(SolveB|SolveA!(¬≍"ZZZ")"AAA")

